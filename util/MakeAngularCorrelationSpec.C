//g++ MakeAngularCorrelationSpec.C -std=c++0x -I$GRSISYS/include -L$GRSISYS/libraries -lGRSIFormat `root-config --cflags --libs` -lTreePlayer -o MakeAngularCorrelationSpec





//Takes in a FargmentTree, makes CES time diff spectra
//
//
#include <utility>
#include <vector>
#include <cstdio>

#include <map>
#include "TROOT.h"
#include <tgmath.h>
#include "TFitResult.h"
#include "TFitResultPtr.h"
#include "TRandom.h"
#include "TVirtualFitter.h"

#include "TTree.h"
#include "TTreeIndex.h"
#include "TVirtualIndex.h"
#include "TFile.h"
#include "TList.h"
#include "TH1F.h"
#include "TH1D.h"
#include "TH2F.h"
#include "TH3F.h"
#include "TMath.h"
#include "TGraphErrors.h"
#include "TF1.h"

#include "TFragment.h"
#include "TChannel.h"

 Double_t BestFitEver(Double_t *dim, Double_t *par){
    return par[0] + par[1]/2*(3*dim[0]*dim[0] -1) + par[2]/8*(35*dim[0]*dim[0]*dim[0]*dim[0]-30*dim[0]*dim[0]+3);
 }

TList *MakeTimeDiffSpec(TTree *tree) {

   const size_t MEM_SIZE = (size_t)1024*(size_t)1024*(size_t)1024*(size_t)8; // 8 GB
//Crystal Method information   
double GriffinCryMap[64][64] = {
      {0.0000, 19.131, 27.184, 19.131, 49.631, 60.157, 46.607, 33.166, 72.817, 91.582, 88.418, 69.473, 49.631, 65.195, 76.694, 62.720, 60.157, 76.694, 86.721, 71.054, 44.341, 63.403, 66.891, 48.703, 53.690, 71.054, 65.195, 46.607, 78.429, 94.836, 82.965, 67.049, 103.31, 119.84, 108.95, 93.279, 116.60, 135.66, 131.30, 113.11, 108.95, 126.31, 133.39, 114.81, 85.164, 101.57, 112.95, 97.035, 88.418, 107.18, 110.53, 91.582, 114.81, 130.37, 117.28, 103.31, 160.87, 180.00, 160.87, 152.82, 119.84, 130.37, 146.83, 133.39},
      {19.131, 0.0000, 19.131, 27.184, 65.195, 71.054, 53.690, 46.607, 91.582, 110.53, 107.18, 88.418, 60.157, 71.054, 86.721, 76.694, 49.631, 62.720, 76.694, 65.195, 25.235, 44.341, 48.703, 31.860, 46.607, 60.157, 49.631, 33.166, 82.965, 94.836, 78.429, 67.049, 117.28, 130.37, 114.81, 103.31, 135.66, 154.77, 148.14, 131.30, 119.84, 133.39, 146.83, 130.37, 85.164, 97.035, 112.95, 101.57, 69.473, 88.418, 91.582, 72.817, 108.95, 119.84, 103.31, 93.279, 180.00, 160.87, 152.82, 160.87, 108.95, 114.81, 133.39, 126.31},
      {27.184, 19.131, 0.0000, 19.131, 76.694, 86.721, 71.054, 60.157, 88.418, 107.18, 110.53, 91.582, 46.607, 53.690, 71.054, 65.195, 33.166, 49.631, 60.157, 46.607, 31.860, 48.703, 44.341, 25.235, 65.195, 76.694, 62.720, 49.631, 101.57, 112.95, 97.035, 85.164, 130.37, 146.83, 133.39, 119.84, 131.30, 148.14, 154.77, 135.66, 103.31, 114.81, 130.37, 117.28, 67.049, 78.429, 94.836, 82.965, 72.817, 91.582, 88.418, 69.473, 126.31, 133.39, 114.81, 108.95, 160.87, 152.82, 160.87, 180.00, 93.279, 103.31, 119.84, 108.95},
      {19.131, 27.184, 19.131, 0.0000, 62.720, 76.694, 65.195, 49.631, 69.473, 88.418, 91.582, 72.817, 33.166, 46.607, 60.157, 49.631, 46.607, 65.195, 71.054, 53.690, 48.703, 66.891, 63.403, 44.341, 71.054, 86.721, 76.694, 60.157, 97.035, 112.95, 101.57, 85.164, 114.81, 133.39, 126.31, 108.95, 113.11, 131.30, 135.66, 116.60, 93.279, 108.95, 119.84, 103.31, 67.049, 82.965, 94.836, 78.429, 91.582, 110.53, 107.18, 88.418, 133.39, 146.83, 130.37, 119.84, 152.82, 160.87, 180.00, 160.87, 103.31, 117.28, 130.37, 114.81},
      {49.631, 65.195, 76.694, 62.720, 0.0000, 19.131, 27.184, 19.131, 49.631, 60.157, 46.607, 33.166, 72.817, 91.582, 88.418, 69.473, 108.95, 126.31, 133.39, 114.81, 85.164, 101.57, 112.95, 97.035, 60.157, 76.694, 86.721, 71.054, 44.341, 63.403, 66.891, 48.703, 53.690, 71.054, 65.195, 46.607, 78.429, 94.836, 82.965, 67.049, 103.31, 119.84, 108.95, 93.279, 116.60, 135.66, 131.30, 113.11, 119.84, 130.37, 146.83, 133.39, 88.418, 107.18, 110.53, 91.582, 114.81, 130.37, 117.28, 103.31, 160.87, 180.00, 160.87, 152.82},
      {60.157, 71.054, 86.721, 76.694, 19.131, 0.0000, 19.131, 27.184, 65.195, 71.054, 53.690, 46.607, 91.582, 110.53, 107.18, 88.418, 119.84, 133.39, 146.83, 130.37, 85.164, 97.035, 112.95, 101.57, 49.631, 62.720, 76.694, 65.195, 25.235, 44.341, 48.703, 31.860, 46.607, 60.157, 49.631, 33.166, 82.965, 94.836, 78.429, 67.049, 117.28, 130.37, 114.81, 103.31, 135.66, 154.77, 148.14, 131.30, 108.95, 114.81, 133.39, 126.31, 69.473, 88.418, 91.582, 72.817, 108.95, 119.84, 103.31, 93.279, 180.00, 160.87, 152.82, 160.87},
      {46.607, 53.690, 71.054, 65.195, 27.184, 19.131, 0.0000, 19.131, 76.694, 86.721, 71.054, 60.157, 88.418, 107.18, 110.53, 91.582, 103.31, 114.81, 130.37, 117.28, 67.049, 78.429, 94.836, 82.965, 33.166, 49.631, 60.157, 46.607, 31.860, 48.703, 44.341, 25.235, 65.195, 76.694, 62.720, 49.631, 101.57, 112.95, 97.035, 85.164, 130.37, 146.83, 133.39, 119.84, 131.30, 148.14, 154.77, 135.66, 93.279, 103.31, 119.84, 108.95, 72.817, 91.582, 88.418, 69.473, 126.31, 133.39, 114.81, 108.95, 160.87, 152.82, 160.87, 180},
      {33.166, 46.607, 60.157, 49.631, 19.131, 27.184, 19.131, 0.0000, 62.720, 76.694, 65.195, 49.631, 69.473, 88.418, 91.582, 72.817, 93.279, 108.95, 119.84, 103.31, 67.049, 82.965, 94.836, 78.429, 46.607, 65.195, 71.054, 53.690, 48.703, 66.891, 63.403, 44.341, 71.054, 86.721, 76.694, 60.157, 97.035, 112.95, 101.57, 85.164, 114.81, 133.39, 126.31, 108.95, 113.11, 131.30, 135.66, 116.60, 103.31, 117.28, 130.37, 114.81, 91.582, 110.53, 107.18, 88.418, 133.39, 146.83, 130.37, 119.84, 152.82, 160.87, 180.00, 160.87},
      {72.817, 91.582, 88.418, 69.473, 49.631, 65.195, 76.694, 62.720, 0.0000, 19.131, 27.184, 19.131, 49.631, 60.157, 46.607, 33.166, 103.31, 119.84, 108.95, 93.279, 116.60, 135.66, 131.30, 113.11, 108.95, 126.31, 133.39, 114.81, 85.164, 101.57, 112.95, 97.035, 60.157, 76.694, 86.721, 71.054, 44.341, 63.403, 66.891, 48.703, 53.690, 71.054, 65.195, 46.607, 78.429, 94.836, 82.965, 67.049, 160.87, 180.00, 160.87, 152.82, 119.84, 130.37, 146.83, 133.39, 88.418, 107.18, 110.53, 91.582, 114.81, 130.37, 117.28, 103.31},
      {91.582, 110.53, 107.18, 88.418, 60.157, 71.054, 86.721, 76.694, 19.131, 0.0000, 19.131, 27.184, 65.195, 71.054, 53.690, 46.607, 117.28, 130.37, 114.81, 103.31, 135.66, 154.77, 148.14, 131.30, 119.84, 133.39, 146.83, 130.37, 85.164, 97.035, 112.95, 101.57, 49.631, 62.720, 76.694, 65.195, 25.235, 44.341, 48.703, 31.860, 46.607, 60.157, 49.631, 33.166, 82.965, 94.836, 78.429, 67.049, 180.00, 160.87, 152.82, 160.87, 108.95, 114.81, 133.39, 126.31, 69.473, 88.418, 91.582, 72.817, 108.95, 119.84, 103.31, 93.279},
      {88.418, 107.18, 110.53, 91.582, 46.607, 53.690, 71.054, 65.195, 27.184, 19.131, 0.0000, 19.131, 76.694, 86.721, 71.054, 60.157, 130.37, 146.83, 133.39, 119.84, 131.30, 148.14, 154.77, 135.66, 103.31, 114.81, 130.37, 117.28, 67.049, 78.429, 94.836, 82.965, 33.166, 49.631, 60.157, 46.607, 31.860, 48.703, 44.341, 25.235, 65.195, 76.694, 62.720, 49.631, 101.57, 112.95, 97.035, 85.164, 160.87, 152.82, 160.87, 180.00, 93.279, 103.31, 119.84, 108.95, 72.817, 91.582, 88.418, 69.473, 126.31, 133.39, 114.81, 108.95},
      {69.473, 88.418, 91.582, 72.817, 33.166, 46.607, 60.157, 49.631, 19.131, 27.184, 19.131, 0.0000, 62.720, 76.694, 65.195, 49.631, 114.81, 133.39, 126.31, 108.95, 113.11, 131.30, 135.66, 116.60, 93.279, 108.95, 119.84, 103.31, 67.049, 82.965, 94.836, 78.429, 46.607, 65.195, 71.054, 53.690, 48.703, 66.891, 63.403, 44.341, 71.054, 86.721, 76.694, 60.157, 97.035, 112.95, 101.57, 85.164, 152.82, 160.87, 180.00, 160.87, 103.31, 117.28, 130.37, 114.81, 91.582, 110.53, 107.18, 88.418, 133.39, 146.83, 130.37, 119.84},
      {49.631, 60.157, 46.607, 33.166, 72.817, 91.582, 88.418, 69.473, 49.631, 65.195, 76.694, 62.720, 0.0000, 19.131, 27.184, 19.131, 53.690, 71.054, 65.195, 46.607, 78.429, 94.836, 82.965, 67.049, 103.31, 119.84, 108.95, 93.279, 116.60, 135.66, 131.30, 113.11, 108.95, 126.31, 133.39, 114.81, 85.164, 101.57, 112.95, 97.035, 60.157, 76.694, 86.721, 71.054, 44.341, 63.403, 66.891, 48.703, 114.81, 130.37, 117.28, 103.31, 160.87, 180.00, 160.87, 152.82, 119.84, 130.37, 146.83, 133.39, 88.418, 107.18, 110.53, 91.582},
      {65.195, 71.054, 53.690, 46.607, 91.582, 110.53, 107.18, 88.418, 60.157, 71.054, 86.721, 76.694, 19.131, 0.0000, 19.131, 27.184, 46.607, 60.157, 49.631, 33.166, 82.965, 94.836, 78.429, 67.049, 117.28, 130.37, 114.81, 103.31, 135.66, 154.77, 148.14, 131.30, 119.84, 133.39, 146.83, 130.37, 85.164, 97.035, 112.95, 101.57, 49.631, 62.720, 76.694, 65.195, 25.235, 44.341, 48.703, 31.860, 108.95, 119.84, 103.31, 93.279, 180.00, 160.87, 152.82, 160.87, 108.95, 114.81, 133.39, 126.31, 69.473, 88.418, 91.582, 72.817},
      {76.694, 86.721, 71.054, 60.157, 88.418, 107.18, 110.53, 91.582, 46.607, 53.690, 71.054, 65.195, 27.184, 19.131, 0.0000, 19.131, 65.195, 76.694, 62.720, 49.631, 101.57, 112.95, 97.035, 85.164, 130.37, 146.83, 133.39, 119.84, 131.30, 148.14, 154.77, 135.66, 103.31, 114.81, 130.37, 117.28, 67.049, 78.429, 94.836, 82.965, 33.166, 49.631, 60.157, 46.607, 31.860, 48.703, 44.341, 25.235, 126.31, 133.39, 114.81, 108.95, 160.87, 152.82, 160.87, 180.00, 93.279, 103.31, 119.84, 108.95, 72.817, 91.582, 88.418, 69.473},
      {62.720, 76.694, 65.195, 49.631, 69.473, 88.418, 91.582, 72.817, 33.166, 46.607, 60.157, 49.631, 19.131, 27.184, 19.131, 0.0000, 71.054, 86.721, 76.694, 60.157, 97.035, 112.95, 101.57, 85.164, 114.81, 133.39, 126.31, 108.95, 113.11, 131.30, 135.66, 116.60, 93.279, 108.95, 119.84, 103.31, 67.049, 82.965, 94.836, 78.429, 46.607, 65.195, 71.054, 53.690, 48.703, 66.891, 63.403, 44.341, 133.39, 146.83, 130.37, 119.84, 152.82, 160.87, 180.00, 160.87, 103.31, 117.28, 130.37, 114.81, 91.582, 110.53, 107.18, 88.418},
      {60.157, 49.631, 33.166, 46.607, 108.95, 119.84, 103.31, 93.279, 103.31, 117.28, 130.37, 114.81, 53.690, 46.607, 65.195, 71.054, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 62.720, 76.694, 65.195, 49.631, 133.39, 126.31, 108.95, 114.81, 130.37, 119.84, 133.39, 146.83, 60.157, 71.054, 86.721, 76.694},
      {76.694, 62.720, 49.631, 65.195, 126.31, 133.39, 114.81, 108.95, 119.84, 130.37, 146.83, 133.39, 71.054, 60.157, 76.694, 86.721, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 49.631, 60.157, 46.607, 33.166, 119.84, 108.95, 93.279, 103.31, 117.28, 103.31, 114.81, 130.37, 46.607, 53.690, 71.054, 65.195},
      {86.721, 76.694, 60.157, 71.054, 133.39, 146.83, 130.37, 119.84, 108.95, 114.81, 133.39, 126.31, 65.195, 49.631, 62.720, 76.694, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 65.195, 71.054, 53.690, 46.607, 130.37, 114.81, 103.31, 117.28, 103.31, 93.279, 108.95, 119.84, 33.166, 46.607, 60.157, 49.631},
      {71.054, 65.195, 46.607, 53.690, 114.81, 130.37, 117.28, 103.31, 93.279, 103.31, 119.84, 108.95, 46.607, 33.166, 49.631, 60.157, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 76.694, 86.721, 71.054, 60.157, 146.83, 133.39, 119.84, 130.37, 114.81, 108.95, 126.31, 133.39, 49.631, 65.195, 76.694, 62.720},
      {44.341, 25.235, 31.860, 48.703, 85.164, 85.164, 67.049, 67.049, 116.60, 135.66, 131.30, 113.11, 78.429, 82.965, 101.57, 97.035, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 63.403, 66.891, 48.703, 97.035, 101.57, 82.965, 78.429, 154.77, 135.66, 131.30, 148.14, 94.836, 94.836, 112.95, 112.95},
      {63.403, 44.341, 48.703, 66.891, 101.57, 97.035, 78.429, 82.965, 135.66, 154.77, 148.14, 131.30, 94.836, 94.836, 112.95, 112.95, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 25.235, 44.341, 48.703, 31.860, 85.164, 85.164, 67.049, 67.049, 135.66, 116.60, 113.11, 131.30, 82.965, 78.429, 97.035, 101.57},
      {66.891, 48.703, 44.341, 63.403, 112.95, 112.95, 94.836, 94.836, 131.30, 148.14, 154.77, 135.66, 82.965, 78.429, 97.035, 101.57, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 48.703, 44.341, 25.235, 101.57, 97.035, 78.429, 82.965, 131.30, 113.11, 116.60, 135.66, 67.049, 67.049, 85.164, 85.164},
      {48.703, 31.860, 25.235, 44.341, 97.035, 101.57, 82.965, 78.429, 113.11, 131.30, 135.66, 116.60, 67.049, 67.049, 85.164, 85.164, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 48.703, 66.891, 63.403, 44.341, 112.95, 112.95, 94.836, 94.836, 148.14, 131.30, 135.66, 154.77, 78.429, 82.965, 101.57, 97.035},
      {53.690, 46.607, 65.195, 71.054, 60.157, 49.631, 33.166, 46.607, 108.95, 119.84, 103.31, 93.279, 103.31, 117.28, 130.37, 114.81, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 60.157, 71.054, 86.721, 76.694, 62.720, 76.694, 65.195, 49.631, 133.39, 126.31, 108.95, 114.81, 130.37, 119.84, 133.39, 146.83},
      {71.054, 60.157, 76.694, 86.721, 76.694, 62.720, 49.631, 65.195, 126.31, 133.39, 114.81, 108.95, 119.84, 130.37, 146.83, 133.39, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 46.607, 53.690, 71.054, 65.195, 49.631, 60.157, 46.607, 33.166, 119.84, 108.95, 93.279, 103.31, 117.28, 103.31, 114.81, 130.37},
      {65.195, 49.631, 62.720, 76.694, 86.721, 76.694, 60.157, 71.054, 133.39, 146.83, 130.37, 119.84, 108.95, 114.81, 133.39, 126.31, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 33.166, 46.607, 60.157, 49.631, 65.195, 71.054, 53.690, 46.607, 130.37, 114.81, 103.31, 117.28, 103.31, 93.279, 108.95, 119.84},
      {46.607, 33.166, 49.631, 60.157, 71.054, 65.195, 46.607, 53.690, 114.81, 130.37, 117.28, 103.31, 93.279, 103.31, 119.84, 108.95, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 49.631, 65.195, 76.694, 62.720, 76.694, 86.721, 71.054, 60.157, 146.83, 133.39, 119.84, 130.37, 114.81, 108.95, 126.31, 133.39},
      {78.429, 82.965, 101.57, 97.035, 44.341, 25.235, 31.860, 48.703, 85.164, 85.164, 67.049, 67.049, 116.60, 135.66, 131.30, 113.11, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 94.836, 94.836, 112.95, 112.95, 44.341, 63.403, 66.891, 48.703, 97.035, 101.57, 82.965, 78.429, 154.77, 135.66, 131.30, 148.14},
      {94.836, 94.836, 112.95, 112.95, 63.403, 44.341, 48.703, 66.891, 101.57, 97.035, 78.429, 82.965, 135.66, 154.77, 148.14, 131.30, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 82.965, 78.429, 97.035, 101.57, 25.235, 44.341, 48.703, 31.860, 85.164, 85.164, 67.049, 67.049, 135.66, 116.60, 113.11, 131.30},
      {82.965, 78.429, 97.035, 101.57, 66.891, 48.703, 44.341, 63.403, 112.95, 112.95, 94.836, 94.836, 131.30, 148.14, 154.77, 135.66, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 67.049, 67.049, 85.164, 85.164, 31.860, 48.703, 44.341, 25.235, 101.57, 97.035, 78.429, 82.965, 131.30, 113.11, 116.60, 135.66},
      {67.049, 67.049, 85.164, 85.164, 48.703, 31.860, 25.235, 44.341, 97.035, 101.57, 82.965, 78.429, 113.11, 131.30, 135.66, 116.60, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 78.429, 82.965, 101.57, 97.035, 48.703, 66.891, 63.403, 44.341, 112.95, 112.95, 94.836, 94.836, 148.14, 131.30, 135.66, 154.77},
      {103.31, 117.28, 130.37, 114.81, 53.690, 46.607, 65.195, 71.054, 60.157, 49.631, 33.166, 46.607, 108.95, 119.84, 103.31, 93.279, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 130.37, 119.84, 133.39, 146.83, 60.157, 71.054, 86.721, 76.694, 62.720, 76.694, 65.195, 49.631, 133.39, 126.31, 108.95, 114.81},
      {119.84, 130.37, 146.83, 133.39, 71.054, 60.157, 76.694, 86.721, 76.694, 62.720, 49.631, 65.195, 126.31, 133.39, 114.81, 108.95, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 117.28, 103.31, 114.81, 130.37, 46.607, 53.690, 71.054, 65.195, 49.631, 60.157, 46.607, 33.166, 119.84, 108.95, 93.279, 103.31},
      {108.95, 114.81, 133.39, 126.31, 65.195, 49.631, 62.720, 76.694, 86.721, 76.694, 60.157, 71.054, 133.39, 146.83, 130.37, 119.84, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 103.31, 93.279, 108.95, 119.84, 33.166, 46.607, 60.157, 49.631, 65.195, 71.054, 53.690, 46.607, 130.37, 114.81, 103.31, 117.28},
      {93.279, 103.31, 119.84, 108.95, 46.607, 33.166, 49.631, 60.157, 71.054, 65.195, 46.607, 53.690, 114.81, 130.37, 117.28, 103.31, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 114.81, 108.95, 126.31, 133.39, 49.631, 65.195, 76.694, 62.720, 76.694, 86.721, 71.054, 60.157, 146.83, 133.39, 119.84, 130.37},
      {116.60, 135.66, 131.30, 113.11, 78.429, 82.965, 101.57, 97.035, 44.341, 25.235, 31.860, 48.703, 85.164, 85.164, 67.049, 67.049, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 154.77, 135.66, 131.30, 148.14, 94.836, 94.836, 112.95, 112.95, 44.341, 63.403, 66.891, 48.703, 97.035, 101.57, 82.965, 78.429},
      {135.66, 154.77, 148.14, 131.30, 94.836, 94.836, 112.95, 112.95, 63.403, 44.341, 48.703, 66.891, 101.57, 97.035, 78.429, 82.965, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 116.60, 113.11, 131.30, 82.965, 78.429, 97.035, 101.57, 25.235, 44.341, 48.703, 31.860, 85.164, 85.164, 67.049, 67.049},
      {131.30, 148.14, 154.77, 135.66, 82.965, 78.429, 97.035, 101.57, 66.891, 48.703, 44.341, 63.403, 112.95, 112.95, 94.836, 94.836, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 131.30, 113.11, 116.60, 135.66, 67.049, 67.049, 85.164, 85.164, 31.860, 48.703, 44.341, 25.235, 101.57, 97.035, 78.429, 82.965},
      {113.11, 131.30, 135.66, 116.60, 67.049, 67.049, 85.164, 85.164, 48.703, 31.860, 25.235, 44.341, 97.035, 101.57, 82.965, 78.429, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 131.30, 135.66, 154.77, 78.429, 82.965, 101.57, 97.035, 48.703, 66.891, 63.403, 44.341, 112.95, 112.95, 94.836, 94.836},
      {108.95, 119.84, 103.31, 93.279, 103.31, 117.28, 130.37, 114.81, 53.690, 46.607, 65.195, 71.054, 60.157, 49.631, 33.166, 46.607, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 44.341, 48.703, 31.860, 25.235, 133.39, 126.31, 108.95, 114.81, 130.37, 119.84, 133.39, 146.83, 60.157, 71.054, 86.721, 76.694, 62.720, 76.694, 65.195, 49.631},
      {126.31, 133.39, 114.81, 108.95, 119.84, 130.37, 146.83, 133.39, 71.054, 60.157, 76.694, 86.721, 76.694, 62.720, 49.631, 65.195, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 48.703, 44.341, 25.235, 31.860, 119.84, 108.95, 93.279, 103.31, 117.28, 103.31, 114.81, 130.37, 46.607, 53.690, 71.054, 65.195, 49.631, 60.157, 46.607, 33.166},
      {133.39, 146.83, 130.37, 119.84, 108.95, 114.81, 133.39, 126.31, 65.195, 49.631, 62.720, 76.694, 86.721, 76.694, 60.157, 71.054, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 66.891, 63.403, 44.341, 48.703, 130.37, 114.81, 103.31, 117.28, 103.31, 93.279, 108.95, 119.84, 33.166, 46.607, 60.157, 49.631, 65.195, 71.054, 53.690, 46.607},
      {114.81, 130.37, 117.28, 103.31, 93.279, 103.31, 119.84, 108.95, 46.607, 33.166, 49.631, 60.157, 71.054, 65.195, 46.607, 53.690, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 63.403, 66.891, 48.703, 44.341, 146.83, 133.39, 119.84, 130.37, 114.81, 108.95, 126.31, 133.39, 49.631, 65.195, 76.694, 62.720, 76.694, 86.721, 71.054, 60.157},
      {85.164, 85.164, 67.049, 67.049, 116.60, 135.66, 131.30, 113.11, 78.429, 82.965, 101.57, 97.035, 44.341, 25.235, 31.860, 48.703, 44.341, 48.703, 31.860, 25.235, 88.418, 91.582, 72.817, 69.473, 131.30, 135.66, 116.60, 113.11, 160.87, 180.00, 160.87, 152.82, 131.30, 135.66, 154.77, 148.14, 88.418, 91.582, 110.53, 107.18, 44.341, 48.703, 66.891, 63.403, 0.0000, 19.131, 27.184, 19.131, 97.035, 101.57, 82.965, 78.429, 154.77, 135.66, 131.30, 148.14, 94.836, 94.836, 112.95, 112.95, 44.341, 63.403, 66.891, 48.703},
      {101.57, 97.035, 78.429, 82.965, 135.66, 154.77, 148.14, 131.30, 94.836, 94.836, 112.95, 112.95, 63.403, 44.341, 48.703, 66.891, 48.703, 44.341, 25.235, 31.860, 91.582, 88.418, 69.473, 72.817, 135.66, 131.30, 113.11, 116.60, 180.00, 160.87, 152.82, 160.87, 135.66, 131.30, 148.14, 154.77, 91.582, 88.418, 107.18, 110.53, 48.703, 44.341, 63.403, 66.891, 19.131, 0.0000, 19.131, 27.184, 85.164, 85.164, 67.049, 67.049, 135.66, 116.60, 113.11, 131.30, 82.965, 78.429, 97.035, 101.57, 25.235, 44.341, 48.703, 31.860},
      {112.95, 112.95, 94.836, 94.836, 131.30, 148.14, 154.77, 135.66, 82.965, 78.429, 97.035, 101.57, 66.891, 48.703, 44.341, 63.403, 66.891, 63.403, 44.341, 48.703, 110.53, 107.18, 88.418, 91.582, 154.77, 148.14, 131.30, 135.66, 160.87, 152.82, 160.87, 180.00, 116.60, 113.11, 131.30, 135.66, 72.817, 69.473, 88.418, 91.582, 31.860, 25.235, 44.341, 48.703, 27.184, 19.131, 0.0000, 19.131, 101.57, 97.035, 78.429, 82.965, 131.30, 113.11, 116.60, 135.66, 67.049, 67.049, 85.164, 85.164, 31.860, 48.703, 44.341, 25.235},
      {97.035, 101.57, 82.965, 78.429, 113.11, 131.30, 135.66, 116.60, 67.049, 67.049, 85.164, 85.164, 48.703, 31.860, 25.235, 44.341, 63.403, 66.891, 48.703, 44.341, 107.18, 110.53, 91.582, 88.418, 148.14, 154.77, 135.66, 131.30, 152.82, 160.87, 180.00, 160.87, 113.11, 116.60, 135.66, 131.30, 69.473, 72.817, 91.582, 88.418, 25.235, 31.860, 48.703, 44.341, 19.131, 27.184, 19.131, 0.0000, 112.95, 112.95, 94.836, 94.836, 148.14, 131.30, 135.66, 154.77, 78.429, 82.965, 101.57, 97.035, 48.703, 66.891, 63.403, 44.341},
      {88.418, 69.473, 72.817, 91.582, 119.84, 108.95, 93.279, 103.31, 160.87, 180.00, 160.87, 152.82, 114.81, 108.95, 126.31, 133.39, 62.720, 49.631, 65.195, 76.694, 44.341, 25.235, 31.860, 48.703, 60.157, 46.607, 33.166, 49.631, 94.836, 82.965, 67.049, 78.429, 130.37, 117.28, 103.31, 114.81, 154.77, 135.66, 131.30, 148.14, 133.39, 119.84, 130.37, 146.83, 97.035, 85.164, 101.57, 112.95, 0.0000, 19.131, 27.184, 19.131, 71.054, 65.195, 46.607, 53.690, 110.53, 91.582, 88.418, 107.18, 71.054, 60.157, 76.694, 86.721},
      {107.18, 88.418, 91.582, 110.53, 130.37, 114.81, 103.31, 117.28, 180.00, 160.87, 152.82, 160.87, 130.37, 119.84, 133.39, 146.83, 76.694, 60.157, 71.054, 86.721, 63.403, 44.341, 48.703, 66.891, 71.054, 53.690, 46.607, 65.195, 94.836, 78.429, 67.049, 82.965, 119.84, 103.31, 93.279, 108.95, 135.66, 116.60, 113.11, 131.30, 126.31, 108.95, 114.81, 133.39, 101.57, 85.164, 97.035, 112.95, 19.131, 0.0000, 19.131, 27.184, 60.157, 49.631, 33.166, 46.607, 91.582, 72.817, 69.473, 88.418, 65.195, 49.631, 62.720, 76.694},
      {110.53, 91.582, 88.418, 107.18, 146.83, 133.39, 119.84, 130.37, 160.87, 152.82, 160.87, 180.00, 117.28, 103.31, 114.81, 130.37, 65.195, 46.607, 53.690, 71.054, 66.891, 48.703, 44.341, 63.403, 86.721, 71.054, 60.157, 76.694, 112.95, 97.035, 85.164, 101.57, 133.39, 114.81, 108.95, 126.31, 131.30, 113.11, 116.60, 135.66, 108.95, 93.279, 103.31, 119.84, 82.965, 67.049, 78.429, 94.836, 27.184, 19.131, 0.0000, 19.131, 76.694, 62.720, 49.631, 65.195, 88.418, 69.473, 72.817, 91.582, 46.607, 33.166, 49.631, 60.157},
      {91.582, 72.817, 69.473, 88.418, 133.39, 126.31, 108.95, 114.81, 152.82, 160.87, 180.00, 160.87, 103.31, 93.279, 108.95, 119.84, 49.631, 33.166, 46.607, 60.157, 48.703, 31.860, 25.235, 44.341, 76.694, 65.195, 49.631, 62.720, 112.95, 101.57, 85.164, 97.035, 146.83, 130.37, 119.84, 133.39, 148.14, 131.30, 135.66, 154.77, 114.81, 103.31, 117.28, 130.37, 78.429, 67.049, 82.965, 94.836, 19.131, 27.184, 19.131, 0.0000, 86.721, 76.694, 60.157, 71.054, 107.18, 88.418, 91.582, 110.53, 53.690, 46.607, 65.195, 71.054},
      {114.81, 108.95, 126.31, 133.39, 88.418, 69.473, 72.817, 91.582, 119.84, 108.95, 93.279, 103.31, 160.87, 180.00, 160.87, 152.82, 133.39, 119.84, 130.37, 146.83, 97.035, 85.164, 101.57, 112.95, 62.720, 49.631, 65.195, 76.694, 44.341, 25.235, 31.860, 48.703, 60.157, 46.607, 33.166, 49.631, 94.836, 82.965, 67.049, 78.429, 130.37, 117.28, 103.31, 114.81, 154.77, 135.66, 131.30, 148.14, 71.054, 60.157, 76.694, 86.721, 0.0000, 19.131, 27.184, 19.131, 71.054, 65.195, 46.607, 53.690, 110.53, 91.582, 88.418, 107.18},
      {130.37, 119.84, 133.39, 146.83, 107.18, 88.418, 91.582, 110.53, 130.37, 114.81, 103.31, 117.28, 180.00, 160.87, 152.82, 160.87, 126.31, 108.95, 114.81, 133.39, 101.57, 85.164, 97.035, 112.95, 76.694, 60.157, 71.054, 86.721, 63.403, 44.341, 48.703, 66.891, 71.054, 53.690, 46.607, 65.195, 94.836, 78.429, 67.049, 82.965, 119.84, 103.31, 93.279, 108.95, 135.66, 116.60, 113.11, 131.30, 65.195, 49.631, 62.720, 76.694, 19.131, 0.0000, 19.131, 27.184, 60.157, 49.631, 33.166, 46.607, 91.582, 72.817, 69.473, 88.418},
      {117.28, 103.31, 114.81, 130.37, 110.53, 91.582, 88.418, 107.18, 146.83, 133.39, 119.84, 130.37, 160.87, 152.82, 160.87, 180.00, 108.95, 93.279, 103.31, 119.84, 82.965, 67.049, 78.429, 94.836, 65.195, 46.607, 53.690, 71.054, 66.891, 48.703, 44.341, 63.403, 86.721, 71.054, 60.157, 76.694, 112.95, 97.035, 85.164, 101.57, 133.39, 114.81, 108.95, 126.31, 131.30, 113.11, 116.60, 135.66, 46.607, 33.166, 49.631, 60.157, 27.184, 19.131, 0.0000, 19.131, 76.694, 62.720, 49.631, 65.195, 88.418, 69.473, 72.817, 91.582},
      {103.31, 93.279, 108.95, 119.84, 91.582, 72.817, 69.473, 88.418, 133.39, 126.31, 108.95, 114.81, 152.82, 160.87, 180.00, 160.87, 114.81, 103.31, 117.28, 130.37, 78.429, 67.049, 82.965, 94.836, 49.631, 33.166, 46.607, 60.157, 48.703, 31.860, 25.235, 44.341, 76.694, 65.195, 49.631, 62.720, 112.95, 101.57, 85.164, 97.035, 146.83, 130.37, 119.84, 133.39, 148.14, 131.30, 135.66, 154.77, 53.690, 46.607, 65.195, 71.054, 19.131, 27.184, 19.131, 0.0000, 86.721, 76.694, 60.157, 71.054, 107.18, 88.418, 91.582, 110.53},
      {160.87, 180.00, 160.87, 152.82, 114.81, 108.95, 126.31, 133.39, 88.418, 69.473, 72.817, 91.582, 119.84, 108.95, 93.279, 103.31, 130.37, 117.28, 103.31, 114.81, 154.77, 135.66, 131.30, 148.14, 133.39, 119.84, 130.37, 146.83, 97.035, 85.164, 101.57, 112.95, 62.720, 49.631, 65.195, 76.694, 44.341, 25.235, 31.860, 48.703, 60.157, 46.607, 33.166, 49.631, 94.836, 82.965, 67.049, 78.429, 110.53, 91.582, 88.418, 107.18, 71.054, 60.157, 76.694, 86.721, 0.0000, 19.131, 27.184, 19.131, 71.054, 65.195, 46.607, 53.690},
      {180.00, 160.87, 152.82, 160.87, 130.37, 119.84, 133.39, 146.83, 107.18, 88.418, 91.582, 110.53, 130.37, 114.81, 103.31, 117.28, 119.84, 103.31, 93.279, 108.95, 135.66, 116.60, 113.11, 131.30, 126.31, 108.95, 114.81, 133.39, 101.57, 85.164, 97.035, 112.95, 76.694, 60.157, 71.054, 86.721, 63.403, 44.341, 48.703, 66.891, 71.054, 53.690, 46.607, 65.195, 94.836, 78.429, 67.049, 82.965, 91.582, 72.817, 69.473, 88.418, 65.195, 49.631, 62.720, 76.694, 19.131, 0.0000, 19.131, 27.184, 60.157, 49.631, 33.166, 46.607},
      {160.87, 152.82, 160.87, 180.00, 117.28, 103.31, 114.81, 130.37, 110.53, 91.582, 88.418, 107.18, 146.83, 133.39, 119.84, 130.37, 133.39, 114.81, 108.95, 126.31, 131.30, 113.11, 116.60, 135.66, 108.95, 93.279, 103.31, 119.84, 82.965, 67.049, 78.429, 94.836, 65.195, 46.607, 53.690, 71.054, 66.891, 48.703, 44.341, 63.403, 86.721, 71.054, 60.157, 76.694, 112.95, 97.035, 85.164, 101.57, 88.418, 69.473, 72.817, 91.582, 46.607, 33.166, 49.631, 60.157, 27.184, 19.131, 0.0000, 19.131, 76.694, 62.720, 49.631, 65.195},
      {152.82, 160.87, 180.00, 160.87, 103.31, 93.279, 108.95, 119.84, 91.582, 72.817, 69.473, 88.418, 133.39, 126.31, 108.95, 114.81, 146.83, 130.37, 119.84, 133.39, 148.14, 131.30, 135.66, 154.77, 114.81, 103.31, 117.28, 130.37, 78.429, 67.049, 82.965, 94.836, 49.631, 33.166, 46.607, 60.157, 48.703, 31.860, 25.235, 44.341, 76.694, 65.195, 49.631, 62.720, 112.95, 101.57, 85.164, 97.035, 107.18, 88.418, 91.582, 110.53, 53.690, 46.607, 65.195, 71.054, 19.131, 27.184, 19.131, 0.0000, 86.721, 76.694, 60.157, 71.054},
      {119.84, 108.95, 93.279, 103.31, 160.87, 180.00, 160.87, 152.82, 114.81, 108.95, 126.31, 133.39, 88.418, 69.473, 72.817, 91.582, 60.157, 46.607, 33.166, 49.631, 94.836, 82.965, 67.049, 78.429, 130.37, 117.28, 103.31, 114.81, 154.77, 135.66, 131.30, 148.14, 133.39, 119.84, 130.37, 146.83, 97.035, 85.164, 101.57, 112.95, 62.720, 49.631, 65.195, 76.694, 44.341, 25.235, 31.860, 48.703, 71.054, 65.195, 46.607, 53.690, 110.53, 91.582, 88.418, 107.18, 71.054, 60.157, 76.694, 86.721, 0.0000, 19.131, 27.184, 19.131},
      {130.37, 114.81, 103.31, 117.28, 180.00, 160.87, 152.82, 160.87, 130.37, 119.84, 133.39, 146.83, 107.18, 88.418, 91.582, 110.53, 71.054, 53.690, 46.607, 65.195, 94.836, 78.429, 67.049, 82.965, 119.84, 103.31, 93.279, 108.95, 135.66, 116.60, 113.11, 131.30, 126.31, 108.95, 114.81, 133.39, 101.57, 85.164, 97.035, 112.95, 76.694, 60.157, 71.054, 86.721, 63.403, 44.341, 48.703, 66.891, 60.157, 49.631, 33.166, 46.607, 91.582, 72.817, 69.473, 88.418, 65.195, 49.631, 62.720, 76.694, 19.131, 0.0000, 19.131, 27.184},
      {146.83, 133.39, 119.84, 130.37, 160.87, 152.82, 160.87, 180.00, 117.28, 103.31, 114.81, 130.37, 110.53, 91.582, 88.418, 107.18, 86.721, 71.054, 60.157, 76.694, 112.95, 97.035, 85.164, 101.57, 133.39, 114.81, 108.95, 126.31, 131.30, 113.11, 116.60, 135.66, 108.95, 93.279, 103.31, 119.84, 82.965, 67.049, 78.429, 94.836, 65.195, 46.607, 53.690, 71.054, 66.891, 48.703, 44.341, 63.403, 76.694, 62.720, 49.631, 65.195, 88.418, 69.473, 72.817, 91.582, 46.607, 33.166, 49.631, 60.157, 27.184, 19.131, 0.0000, 19.131},
      {133.39, 126.31, 108.95, 114.81, 152.82, 160.87, 180.00, 160.87, 103.31, 93.279, 108.95, 119.84, 91.582, 72.817, 69.473, 88.418, 76.694, 65.195, 49.631, 62.720, 112.95, 101.57, 85.164, 97.035, 146.83, 130.37, 119.84, 133.39, 148.14, 131.30, 135.66, 154.77, 114.81, 103.31, 117.28, 130.37, 78.429, 67.049, 82.965, 94.836, 49.631, 33.166, 46.607, 60.157, 48.703, 31.860, 25.235, 44.341, 86.721, 76.694, 60.157, 71.054, 107.18, 88.418, 91.582, 110.53, 53.690, 46.607, 65.195, 71.054, 19.131, 27.184, 19.131, 0}
  };
  //memcpy(GriffinCryMap, thisGriffinCryMap, sizeof(GriffinCryMap));

  double GriffinCryMapCombos[52][2] = {
      {0.0000, 64},
      {19.131, 128},
      {25.235, 64},
      {27.184, 64},
      {31.860, 64},
      {33.166, 48},
      {44.341, 128},
      {46.607, 96},
      {48.703, 128},
      {49.631, 96},
      {53.690, 48},
      {60.157, 96},
      {62.720, 48},
      {63.403, 64},
      {65.195, 96},
      {66.891, 64},
      {67.049, 64},
      {69.473, 64},
      {71.054, 96},
      {72.817, 64},
      {76.694, 96},
      {78.429, 64},
      {82.965, 64},
      {85.164, 64},
      {86.721, 48},
      {88.418, 128},
      {91.582, 128},
      {93.279, 48},
      {94.836, 64},
      {97.035, 64},
      {101.57, 64},
      {103.31, 96},
      {107.18, 64},
      {108.95, 96},
      {110.53, 64},
      {112.95, 64},
      {113.11, 64},
      {114.81, 96},
      {116.60, 64},
      {117.28, 48},
      {119.84, 96},
      {126.31, 48},
      {130.37, 96},
      {131.30, 128},
      {133.39, 96},
      {135.66, 128},
      {146.83, 48},
      {148.14, 64},
      {152.82, 64},
      {154.77, 64},
      {160.87, 128},
      {180.00, 64}
  };

Float_t angles[52]       = {0.0000, 19.131, 25.235, 27.184, 31.860, 33.166, 44.341, 46.607, 48.703, 49.631, 53.690, 60.157, 62.720, 63.403, 65.195, 66.891, 67.049, 69.473, 71.054, 72.817, 76.694, 78.429, 82.965, 85.164, 86.721, 88.418, 91.582, 93.279, 94.836, 97.035, 101.57, 103.31, 107.18, 108.95, 110.53, 112.95, 113.11, 114.81, 116.60, 117.28, 119.84, 126.31, 130.37, 131.30, 133.39, 135.66, 146.83, 148.14, 152.82, 154.77, 160.87, 180.00};

Float_t weights[52] = {64,128,64,64,64,48,128,96,128,96,48,96,48,64,96,64,64,64,96,64,96,64,64,64,48,128,128,48,64,64,64,96,64,96,64,64,64,96,64,48,96,48,96,128,96,128,48,64,64,64,128,64}; 


 Float_t cosTheta[52]     = {1,    0.944771731934288,    0.904566789892864,    0.889543984431678,    0.849340400263317,    0.837089096669585,    0.715192775009554,    0.686998737834932,    0.659962330958193,    0.647707774342544,    0.592153830802231,    0.497625071673957,    0.458339340618090,    0.447712269418652,    0.419531299378301,    0.392481596985632,    0.389943759514329,    0.350648738728823,    0.324676879730513,    0.295424600236195,    0.230151646979774,    0.200582087822817,    0.122475632570626,    0.0669008244293115,    0.0571981117143259,    0.0276076005714703,    -0.0276076005714704,    -0.0571981117143258,    -0.0669008244293116,    -0.122475632570626,    -0.200564989204778,    -0.230219585438792,    -0.295374576981412,    -0.324742909980579,    -0.350697773642815,    -0.389927687788188,    -0.392497649763699,    -0.419610513115510,    -0.447759087838770,    -0.458339340618090,    -0.497579654440663,    -0.592153830802231,    -0.647721071713080,    -0.660001667960937,    -0.686960689137425,    -0.715204973482290,    -0.837050902177404,    -0.849340400263317,    -0.889575876378338,    -0.904603990928734,    -0.944777451742548,    -1};

Float_t counts[52]       = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
Float_t err_cosTheta[52] = {0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083,0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083};
  Float_t err_angles[52]   = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
  Float_t err_counts[52]   = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

////Detector Method Information
/*
  double GriffinDetMap[16][16] = {
     {0.0,      60.0,	90.0,	60.0,	60.0,	45.0,	60.0,	90.0,	120.0,	135.0,	120.0,	90.0,	90.0,	120.0,	180.0,	120.0},
     {60.0,	0.0,	60.0,	90.0,	120.0,	90.0,	60.0,	45.0,	60.0,	90.0,	120.0,	135.0,	120.0,	90.0,	120.0,	180.0},
     {90.0,	60.0,	0.0,	60.0,	120.0,	135.0,	120.0,	90.0,	60.0,	45.0,	60.0,	90.0,	180.0,	120.0,	90.0,	120.0},
     {60.0,	90.0,	60.0,	0.0,	60.0,	90.0,	120.0,	135.0,	120.0,	90.0,	60.0,	45.0,	120.0,	180.0,	120.0,	90.0},
     {60.0,	120.0,	120.0,	60.0,	0.0,	45.0,	90.0,	135.0,	180.0,	135.0,	90.0,	45.0,	60.0,	120.0,	120.0,	60.0},
     {45.0,	90.0,	135.0,	90.0,	45.0,	0.0,	45.0,	90.0,	135.0,	180.0,	135.0,	90.0,	45.0,	90.0,	135.0,	90.0},
     {60.0,	60.0,	120.0,	120.0,	90.0,	45.0,	0.0,	45.0,	90.0,	135.0,	180.0,	135.0,	60.0,	60.0,	120.0,	120.0},
     {90.0,	45.0,	90.0,	135.0,	135.0,	90.0,	45.0,	0.0,	45.0,	90.0,	135.0,	180.0,	90.0,	45.0,	90.0,	135.0},
     {120.0,	60.0,	60.0,	120.0,	180.0,	135.0,	90.0,	45.0,	0.0,	45.0,	90.0,	135.0,	120.0,	60.0,	60.0,	120.0},
     {135.0,	90.0,	45.0,	90.0,	135.0,	180.0,	135.0,	90.0,	45.0,	0.0,	45.0,	90.0,	135.0,	90.0,	45.0,	90.0}, 
     {120.0,	120.0,	60.0,	60.0,	90.0,	135.0,	180.0,	135.0,	90.0,	45.0,	0.0,	45.0,	120.0,	120.0,	60.0,	60.0},
     {90.0,	135.0,	90.0,	45.0,	45.0,	90.0,	135.0,	180.0,	135.0,	90.0,	45.0,	0.0,	90.0,	135.0,	90.0,	45.0},
     {90.0,	120.0,	180.0,	120.0,	60.0,	45.0,	60.0,	90.0,	120.0,	135.0,	120.0,	90.0,	0.0,	60.0,	90.0,	60.0},
     {120.0,	90.0,	120.0,	180.0,	120.0,	90.0,	60.0,	45.0,	60.0,	90.0,	120.0,	135.0,	60.0,	0.0,	60.0,	90.0},
     {180.0,	120.0,	90.0,	120.0,	120.0,	135.0,	120.0,	90.0,	60.0,	45.0,	60.0,	90.0,	90.0,	60.0,	0.0,	60.0},
     {120.0,	180.0,	120.0,	90.0,	60.0,	90.0,	120.0,	135.0,	120.0,	90.0,	60.0,	45.0,	60.0,	90.0,	60.0,	0.0},
  };

  double GriffinDetMapCombos[7][2] = {
      {0.0, 16},
      {45.0, 32},
      {60.0, 48}, 
      {90.0, 64},
      {120.0, 48},
      {135.0, 32},
      {180.0, 16},
  };

  Float_t weights[7] = {16, 32, 48, 64, 48, 32, 16};

  Float_t angles[7]     = {0.0, 45.0, 60.0, 90.0, 120.0, 135.0, 180.0};
  Float_t cosTheta[7]   = {1, 0.707106, 0.500, 0.00, -0.500, -0.707106, -1};
  Float_t err_cosTheta[7] = {0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3}; 
  Float_t err_angles[7] = {0, 0, 0, 0, 0, 0, 0};
  Float_t counts[7]     = {0, 0, 0, 0, 0, 0, 0};
  Float_t err_counts[7] = {0, 0, 0, 0, 0, 0, 0};
    */

   int crystalOne = 0;
   int crystalTwo = 0;
   int detectorOne = 0;
   int detectorTwo = 0;
   double cry1energy = 0;
   double cry2energy = 0;
   double det1energy = 0;
   double det2energy = 0;
   double angle = 0;
   double norm = 0;
   double cosAngle = 0;
   long timeWindow = 0;
   int thiscounter = 0;

   TList *list = new TList;

   TFragment *currentFrag = 0;
   //TFragment *oldFrag_beta   = new TFragment; bool first_beta_set  = false;
   //TFragment *oldFrag_gamma  = new TFragment; bool first_gamma_set = false;
   std::vector<std::pair<long,int> > oldBetaTimeStamp;
   std::vector<std::pair<long,int> > oldGammaTimeStamp;

   bool last_beta_filled = false;
   bool last_gamma_filled = false;

   //tree->SetBranchAddress("TFragment",&currentFrag);
   TBranch *branch = tree->GetBranch("TFragment");
   branch->SetAddress(&currentFrag);
   tree->LoadBaskets(MEM_SIZE);

   printf("Tree Index not found, building index on %s/%s...",
          "TimeStampHigh","TimeStampLow");  fflush(stdout);
   tree->BuildIndex("TimeStampHigh","TimeStampLow");
   printf(" done!\n");


   TTreeIndex *index = (TTreeIndex*)tree->GetTreeIndex();
   Long64_t *indexvalues = index->GetIndex();
   int fEntries = index->GetN();

   TChannel::ReadCalFromTree(tree);

   TH1F *gg_diff = new TH1F("gg_diff","gg_diff",12000,-6000,6000);// list->Add(gg_diff);

   TH3F* gamma_gamma_corr_edep_cry = new TH3F("gamma_gamma_corr_edep_cry","gamma_gamma_corr_edep_cry",2000,0,2000,2000,0,2000,180,0,180);// list->Add(gamma_gamma_corr_edep_cry);

TH1F* Singles = new TH1F("gammaOne_edep","gammOne_edep",16000,0,16000);// list->Add(Singles);
TH1F* SinglesTwo = new TH1F("gammaTwo_edep","gammaTwo_edep",16000,0,16000);// list->Add(SinglesTwo);

TH1F* Timing = new TH1F("Coincidence_Timing","Coincidence_Timing", 40,0,200);// list->Add(Timing);

TH2F* TwoDEnergy = new TH2F("gamma_gamma_edep","gamma_gamma_edep",16000,0,16000,16000,0,16000);// list->Add(TwoDEnergy);

TH1D *ProjectZ = new TH1D("Slice", "TH1F Title",1000,-0.5,180.5);// list->Add(ProjectZ);
TH1D *ProjectZ_cos = new TH1D("Slice_cos","Title", 100,-1.01,1.01);// list->Add(ProjectZ_cos);

TH1D *ProjectX[51];
char name[20];
char title[100];
for (Int_t i=1;i<52;i++) {
sprintf(name,"ProjectX%d",i);
sprintf(title,"ProjectX%d",i);
ProjectX[i] = new TH1D(name,title,2500,0,2500);
}



   int FragsIn = 0;

   tree->GetEntry(indexvalues[0]);
   FragsIn++;
 int counter = 0;
   for(long x=1;x<fEntries;x++) {
      if(tree->GetEntry(indexvalues[x]) == -1 ) {
         printf( "FIRE!!!" "\n");
         continue;
      } 
  
double window = 20;
 
      TFragment myFrag  = *currentFrag;
      long time = currentFrag->GetTimeStamp();
      long timelow  = time - window;
      long timehigh = time + window;

	double currEnergy = 0;
	double myEnergy = 0;

   

      int time_low  = (int) (timelow & 0x0fffffff);
      int time_high = (int) (timelow >> 28); 



      //long start = indexvalues[index->FindValues(time_high,time_low)];////tree->GetEntryNumberWithBestIndex(time_high,time_low);
      long start = index->FindValues(time_high,time_low);////tree->GetEntryNumberWithBestIndex(time_high,time_low);

     
      time_low  = (int) (timehigh & 0x0fffffff);
      time_high = (int) (timehigh >> 28); 


    
      //long stop = indexvalues[index->FindValues(time_high,time_low)];////tree->GetEntryNumberWithBestIndex(time_high,time_low);
      long stop = index->FindValues(time_high,time_low);////tree->GetEntryNumberWithBestIndex(time_high,time_low);
     // printf("%ld Energy one is = %lf Energy two is  %lf\n",x,currEnergy,myEnergy);
    //  printf("Time low two is = %ld Time High two is  %ld\n",time_low,time_high);
      for(long y=start;y<stop;y++) {
         if(y == x) {
            continue;
         }
         if(tree->GetEntry(indexvalues[y]) == -1 ) {
            printf( "FIRE!!!" "\n");
            continue;
         } 

///////////Andrew's 3D plot attempt loop over channels hit and use channel address (number) to find angular correlations.
	///////////This plot will be a plot of energy on the x and y axes and cosine of the open angle on the z axis

         //timeWindow = currentFrag->GetTimeStamp() - myFrag.GetTimeStamp();
       
	if(myFrag.DetectorType == 1) { 
	    if(currentFrag->DetectorType == 1) {    //Looking at only GRIFFIN
		cry1energy = currentFrag->GetEnergy();
		cry2energy = myFrag.GetEnergy();
		crystalOne = currentFrag->ChannelNumber;
		crystalTwo = myFrag.ChannelNumber;
		detectorOne = floor(crystalOne/4);
		detectorTwo = floor(crystalTwo/4);
		//printf(" %i %i %i %f %f %f %f             \n",x,crystalOne,crystalTwo, angle, norm, cry1energy, cry2energy);
		angle = GriffinCryMap[crystalOne-1][crystalTwo-1];
		//angle = GriffinDetMap[detectorOne][detectorTwo];
		cosAngle = cos(M_PI/180*angle);
		for(int h = 0; h < 52; h++){
	  	   if(GriffinCryMapCombos[h][0] <= angle +0.01  && GriffinCryMapCombos[h][0] >= angle - 0.01){
	      		norm = (double)(GriffinCryMapCombos[h][1]);
			break;
	   	   } 
		}
	    }
	}
	else{
	    cry1energy = 0.0;
	    cry2energy = 0.0;
	    crystalOne = -1;
	    crystalTwo = -1;
	    detectorOne = -1;
	    detectorTwo = -1;
	    angle = -1.0;
	   // printf("NOT GRIFFIN \n");
	    }


 // if(myFrag.GetTimeStamp() <= 500.0){
	if(crystalOne != -1 && crystalTwo != -1 && detectorOne != -1 && detectorTwo != -1 && angle >= 10.0){
		Singles->Fill(cry1energy);
		SinglesTwo->Fill(cry2energy);
		Timing->Fill(stop-start);
		TwoDEnergy->Fill(cry1energy,cry2energy);
		TwoDEnergy->Fill(cry2energy,cry1energy);
                counter++;
//if(counter%10 ==0 && angle == 180){
		// printf("Time info = %f %f %f    \n",currentFrag->GetTimeStamp(),myFrag.GetTimeStamp(),timeWindow);
//		printf(" %i %i %i %i %i %f %f            \n",x,crystalOne,crystalTwo, detectorOne, detectorTwo, angle, norm);
//		}
		gamma_gamma_corr_edep_cry->Fill(cry2energy,cry1energy,angle);
		gamma_gamma_corr_edep_cry->Fill(cry1energy,cry2energy,angle);
		//gamma_gamma_corr_edep_cry->Write();
	}
    // }
    // }
 //}

    
      }

	
 //}


      if(x%1000000==0)
         printf("\tOn fragment %i/%i               \n",x,fEntries);
      if(x>27000000)
         break;


   }

for(int i = 1; i<52; i++){
     ProjectX[i] = gamma_gamma_corr_edep_cry->ProjectionX(Form("Slice_X_%d",i),gamma_gamma_corr_edep_cry->GetYaxis()->FindBin(1330.5),gamma_gamma_corr_edep_cry->GetYaxis()->FindBin(1334.5),gamma_gamma_corr_edep_cry->GetZaxis()->FindBin(angles[i]),gamma_gamma_corr_edep_cry->GetZaxis()->FindBin(angles[i]));
     ProjectX[i]->Write();
}


   ProjectZ = gamma_gamma_corr_edep_cry->ProjectionZ("Slice",gamma_gamma_corr_edep_cry->GetXaxis()->FindBin(1171.2),gamma_gamma_corr_edep_cry->GetXaxis()->FindBin(1175.2),gamma_gamma_corr_edep_cry->GetYaxis()->FindBin(1330.5),gamma_gamma_corr_edep_cry->GetYaxis()->FindBin(1334.5));

	for(int i = 0; i <52; i++){
		ProjectZ_cos->SetBinContent(ProjectZ_cos->GetXaxis()->FindBin(cosTheta[i]+1) ,ProjectZ->GetBinContent(ProjectZ->GetXaxis()->FindBin(angles[i]+1)));
		double bin = 0;
		bin = ProjectZ_cos->GetBinContent(ProjectZ_cos->GetXaxis()->FindBin(cosTheta[i]));
		printf("%f \n",bin);
	}

	for(int i = 0; i<52; i++){
		if(ProjectZ->GetBinContent(ProjectZ->GetXaxis()->FindBin(angles[i])) >= 0 ){
			counts[i] = ProjectZ->GetBinContent(ProjectZ->GetXaxis()->FindBin(angles[i]));
			thiscounter = thiscounter + 1;
		}
	}

  Float_t new_angles[52];
  Float_t new_counts[52];
  Float_t new_cosTheta[52];
  Float_t err_new_angles[52];
  Float_t err_new_counts[52];
  Float_t err_new_cosTheta[52];
  Float_t err_actual_counts[52];

counter = 0;
  for ( Int_t l=0; l<52; l++) {
      new_angles[counter] = angles[l];
      new_counts[counter] = counts[l];
      new_cosTheta[counter] = cosTheta[l];
      err_new_angles[counter] = err_angles[l];
      err_new_counts[counter] = err_counts[l];
      err_new_cosTheta[counter] = err_cosTheta[l];
      counter = counter + 1;
//  printf("%f \n",angles[l]);

  }
//   new_counts[51] = 46.893;
   new_counts[0] = new_counts[51];//folding 180 degree point to give value of zero degree point
   err_new_counts[0] = err_new_counts[51];

  for ( Int_t l=1; l<51; l++) {
      err_actual_counts[l] = sqrt(counter*weights[l])/weights[l];
  }

 for(int l =0; l<52; l++){
printf("%i \t %f \t %f \t %f \t %f \n",counter,new_cosTheta[l],new_counts[l],err_new_cosTheta[l],err_actual_counts[l]);

}
 


  TF1 *Fit = new TF1("Correlation_Fit",BestFitEver,-1.0,0.99,3);

TGraphErrors *gr = new TGraphErrors(counter,&new_cosTheta[0],&new_counts[0],&err_new_cosTheta[0],&err_actual_counts[0]); //list->Add(gr);

  gr->Draw();
  gr->SetTitle("60Co Gamma-Gamma-Correlation");
  gr->SetMarkerColor(4);
  gr->SetMarkerStyle(21);
 // gr->SetLineColor(1);
  gr->SetMarkerSize(0.9);
  gr->Fit("Correlation_Fit", "RMU","",-0.5,0.5);
  Fit->SetLineColor(2);
  Fit->SetLineWidth(1);
  Fit->SetLineStyle(3);

   list->Add(gr);

   printf(" \n\n");
   return list;
   
}



#ifndef __CINT__ 

int main(int argc, char **argv) { 
   if(argc!=2)  {
      printf("try again.\n");
      return 0;
   }
   TFile *f = new TFile(argv[1]);
   TTree *tree = (TTree*)f->Get("FragmentTree");
   TFile *outfile = new TFile("TimeCorrelations.root","recreate");

   TList *list = MakeTimeDiffSpec(tree);

  // TFile *outfile = new TFile("junk.root","recreate");
   list->Write();

   return 0;

}

#endif






